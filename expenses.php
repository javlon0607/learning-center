<?php require 'config.php';auth();if($_SERVER['REQUEST_METHOD']==='POST'){db()->prepare("INSERT INTO expenses(category,amount,description,expense_date)VALUES(?,?,?,?)")->execute([$_POST['category'],$_POST['amount'],$_POST['description'],$_POST['expense_date']]);header('Location: expenses.php');exit;}$expenses=db()->query("SELECT * FROM expenses ORDER BY expense_date DESC LIMIT 100")->fetchAll();?>
<!DOCTYPE html><html><head><title>Expenses</title><script src="https://cdn.tailwindcss.com"></script><script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script></head><body class="bg-gray-100" x-data="{modal:false,form:{expense_date:new Date().toISOString().split('T')[0]}}"><div class="flex"><nav class="bg-gray-800 text-white w-64 min-h-screen p-4"><h2 class="text-xl font-bold mb-6">Learning CRM</h2><a href="dashboard.php" class="block py-2 px-4 hover:bg-gray-700 rounded mb-2">ğŸ“Š Dashboard</a><a href="students.php" class="block py-2 px-4 hover:bg-gray-700 rounded mb-2">ğŸ‘¥ Students</a><a href="teachers.php" class="block py-2 px-4 hover:bg-gray-700 rounded mb-2">ğŸ‘¨â€ğŸ« Teachers</a><a href="groups.php" class="block py-2 px-4 hover:bg-gray-700 rounded mb-2">ğŸ“š Groups</a><a href="payments.php" class="block py-2 px-4 hover:bg-gray-700 rounded mb-2">ğŸ’° Payments</a><a href="expenses.php" class="block py-2 px-4 bg-gray-700 rounded mb-2">ğŸ“‰ Expenses</a><a href="logout.php" class="block py-2 px-4 hover:bg-red-700 rounded mt-4">ğŸšª Logout</a></nav><main class="flex-1 p-8"><div class="flex justify-between items-center mb-8"><h1 class="text-3xl font-bold">Expenses</h1><button @click="modal=true;form={expense_date:new Date().toISOString().split('T')[0]}" class="bg-red-600 text-white px-4 py-2 rounded">+ Add Expense</button></div><div class="bg-white rounded-lg shadow overflow-hidden"><table class="w-full"><thead class="bg-gray-50"><tr><th class="px-6 py-3 text-left">Date</th><th class="px-6 py-3 text-left">Category</th><th class="px-6 py-3 text-left">Description</th><th class="px-6 py-3 text-left">Amount</th></tr></thead><tbody class="divide-y"><?php foreach($expenses as $e): ?><tr><td class="px-6 py-4"><?=date('M d, Y',strtotime($e['expense_date']))?></td><td class="px-6 py-4"><?=$e['category']?></td><td class="px-6 py-4"><?=$e['description']??'-'?></td><td class="px-6 py-4 font-bold text-red-600">$<?=number_format($e['amount'],2)?></td></tr><?php endforeach; ?></tbody></table></div><div x-show="modal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center" x-cloak style="display:none"><div class="bg-white rounded-lg p-8 w-2/3" @click.away="modal=false"><h2 class="text-2xl font-bold mb-4">Add Expense</h2><form method="POST"><div class="grid grid-cols-2 gap-4"><div><label class="block text-sm mb-1">Category*</label><input type="text" name="category" x-model="form.category" class="w-full border rounded px-3 py-2" required></div><div><label class="block text-sm mb-1">Amount*</label><input type="number" step="0.01" name="amount" x-model="form.amount" class="w-full border rounded px-3 py-2" required></div><div><label class="block text-sm mb-1">Date*</label><input type="date" name="expense_date" x-model="form.expense_date" class="w-full border rounded px-3 py-2" required></div><div><label class="block text-sm mb-1">Description</label><textarea name="description" x-model="form.description" class="w-full border rounded px-3 py-2" rows="3"></textarea></div></div><div class="flex justify-end space-x-3 mt-6"><button type="button" @click="modal=false" class="px-4 py-2 border rounded">Cancel</button><button type="submit" class="px-4 py-2 bg-red-600 text-white rounded">Save</button></div></form></div></div></main></div></body></html>
